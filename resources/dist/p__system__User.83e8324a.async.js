(self.webpackChunkgin_admin_frontend=self.webpackChunkgin_admin_frontend||[]).push([[915],{31184:function(X,_,e){"use strict";var a=e(20034),S=e(16045),x=e(37969),l=e(59496),g=e(74369),K=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],D=l.forwardRef(function(Z,U){var M=Z.fieldProps,Y=Z.unCheckedChildren,u=Z.checkedChildren,j=Z.proFieldProps,F=(0,x.Z)(Z,K);return l.createElement(g.Z,(0,a.Z)({valueType:"switch",mode:"edit",fieldProps:(0,S.Z)({unCheckedChildren:Y,checkedChildren:u},M),ref:U,valuePropName:"checked",proFieldProps:j,filedConfig:{valuePropName:"checked",ignoreWidth:!0}},F))});_.Z=D},46324:function(X,_,e){"use strict";var a=e(20034),S=e(37969),x=e(59496),l=e(74369),g=["fieldProps","proFieldProps"],K=["fieldProps","proFieldProps"],D="text",Z=function(u){var j=u.fieldProps,F=u.proFieldProps,i=(0,S.Z)(u,g);return x.createElement(l.Z,(0,a.Z)({mode:"edit",valueType:D,fieldProps:j,filedConfig:{valueType:D},proFieldProps:F},i))},U=function(u){var j=u.fieldProps,F=u.proFieldProps,i=(0,S.Z)(u,K);return x.createElement(l.Z,(0,a.Z)({mode:"edit",valueType:"password",fieldProps:j,proFieldProps:F,filedConfig:{valueType:D}},i))},M=Z;M.Password=U,M.displayName="ProFormComponent",_.Z=M},94811:function(X,_,e){"use strict";var a=e(20034),S=e(37969),x=e(59496),l=e(74369),g=["fieldProps","proFieldProps"],K=function(Z,U){var M=Z.fieldProps,Y=Z.proFieldProps,u=(0,S.Z)(Z,g);return x.createElement(l.Z,(0,a.Z)({ref:U,mode:"edit",valueType:"textarea",fieldProps:M,proFieldProps:Y},u))};_.Z=x.forwardRef(K)},3049:function(X,_,e){"use strict";e.d(_,{HS:function(){return q},IG:function(){return se},hC:function(){return ee},g2:function(){return ie}});var a=e(47521),S=e(24029),x=e(10407),l=e(56188),g=e(20686),K=e(23258),D=e(78419),Z=e(59496),U=e(16045),M={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"},Y=M,u=e(65858),j=function(s,P){return Z.createElement(u.Z,(0,U.Z)((0,U.Z)({},s),{},{ref:P,icon:Y}))},F=Z.forwardRef(j),i=F,C=e(28470),O=e(77075),G=e(48177),c=e(82305),B=e(85851),H=e(18641),v=e(4637),q=function(s){var P=(0,B.tT)("@@initialState"),E=P.initialState,w=(0,B.YB)(),W=(0,H.$B)(),$=E.routePathCodeMap[W.path],A=E.flatMenus.hasOwnProperty("".concat($,".").concat(s.code));return(0,v.jsx)(v.Fragment,{children:A&&(0,v.jsx)(D.Z,(0,g.Z)((0,g.Z)({icon:(0,v.jsx)(C.Z,{}),type:"primary"},s),{},{title:void 0,children:s.title?s.title:w.formatMessage({id:"button.add"})}))})},se=function(s){var P=(0,B.tT)("@@initialState"),E=P.initialState,w=(0,B.YB)(),W=(0,H.$B)(),$=E.routePathCodeMap[W.path],A=E.flatMenus.hasOwnProperty("".concat($,".").concat(s.code));return(0,v.jsx)(v.Fragment,{children:A&&(0,v.jsx)(l.Z,{title:s.title?s.title:w.formatMessage({id:"button.add",defaultMessage:"\u6DFB\u52A0"}),children:(0,v.jsx)(D.Z,(0,g.Z)((0,g.Z)({size:"middle",shape:"circle",type:"link",icon:(0,v.jsx)(i,{}),style:{border:0}},s),{},{title:void 0}))})})},ee=function(s){var P,E=(0,B.tT)("@@initialState"),w=E.initialState,W=(0,H.$B)(),$=(0,B.YB)(),A=w.routePathCodeMap[W.path],ne=w.flatMenus.hasOwnProperty("".concat(A,".").concat(s.code));return(0,v.jsx)(v.Fragment,{children:ne&&(0,Z.createElement)(S.Z,(0,g.Z)((0,g.Z)({},s),{},{key:"delete",title:s.title,icon:(0,v.jsx)(O.Z,{style:{color:"red"}}),placement:"topLeft",onCancel:function(te){return te.stopPropagation()}}),(0,v.jsx)(l.Z,{title:(P=s.buttonProps)!==null&&P!==void 0&&P.title?s.buttonProps.title:$.formatMessage({id:"button.delete",defaultMessage:"\u5220\u9664"}),children:(0,v.jsx)(D.Z,(0,g.Z)((0,g.Z)({size:"middle",shape:"circle",danger:!0,icon:(0,v.jsx)(G.Z,{}),style:{border:0},onClick:function(te){return te.stopPropagation()}},s.buttonProps),{},{title:void 0}))}))})},ie=function(s){var P=(0,B.tT)("@@initialState"),E=P.initialState,w=(0,B.YB)(),W=(0,H.$B)(),$=E.routePathCodeMap[W.path],A=E.flatMenus.hasOwnProperty("".concat($,".").concat(s.code));return(0,v.jsx)(v.Fragment,{children:A&&(0,v.jsx)(l.Z,{title:s.title?s.title:w.formatMessage({id:"button.edit",defaultMessage:"\u7F16\u8F91"}),children:(0,v.jsx)(D.Z,(0,g.Z)((0,g.Z)({size:"middle",shape:"circle",type:"link",icon:s.icon?s.icon:(0,v.jsx)(c.Z,{}),style:{border:0}},s),{},{title:void 0}))})})},ae=function(s){var P=useModel("@@initialState"),E=P.initialState,w=useIntl(),W=useRouteMatch(),$=E.routePathCodeMap[W.path],A=E.flatMenus.hasOwnProperty("".concat($,".").concat(s.code));return _jsx(_Fragment,{children:A&&_jsx(_Button,_objectSpread(_objectSpread({icon:_jsx(UploadOutlined,{}),type:"primary"},s),{},{title:void 0,children:s.title?s.title:w.formatMessage({id:"button.export",defaultMessage:"\u5BFC\u51FA"})}))})},le=function(s){var P=useModel("@@initialState"),E=P.initialState,w=useIntl(),W=useRouteMatch(),$=E.routePathCodeMap[W.path],A=E.flatMenus.hasOwnProperty("".concat($,".").concat(s.code));return _jsx(_Fragment,{children:A&&_jsx(_Button,_objectSpread(_objectSpread({icon:_jsx(ImportOutlined,{}),type:"primary"},s),{},{title:void 0,children:s.title?s.title:w.formatMessage({id:"button.import",defaultMessage:"\u5BFC\u5165"})}))})}},77377:function(X,_,e){"use strict";e.r(_),e.d(_,{default:function(){return pe}});var a=e(78646),S=e(93166),x=e(50962),l=e(82005),g=e(2986),K=e(74921),D=e(26688),Z=e(44605),U=e(63757),M=e(42273),Y=e(34645),u=e(59496),j=e(85851),F=e(22326),i=e(20686);function C(d,r){return O.apply(this,arguments)}function O(){return O=(0,l.Z)((0,a.Z)().mark(function d(r,t){return(0,a.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,j.WY)("/api/v1/users",(0,i.Z)({method:"GET",params:(0,i.Z)({current:"1",pageSize:"10"},r)},t||{})));case 1:case"end":return n.stop()}},d)})),O.apply(this,arguments)}function G(d,r){return c.apply(this,arguments)}function c(){return c=(0,l.Z)((0,a.Z)().mark(function d(r,t){return(0,a.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,j.WY)("/api/v1/users",(0,i.Z)({method:"POST",data:r},t||{})));case 1:case"end":return n.stop()}},d)})),c.apply(this,arguments)}function B(d,r){return H.apply(this,arguments)}function H(){return H=(0,l.Z)((0,a.Z)().mark(function d(r,t){return(0,a.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,j.WY)("/api/v1/users/".concat(r),(0,i.Z)({method:"GET"},t||{})));case 1:case"end":return n.stop()}},d)})),H.apply(this,arguments)}function v(d,r,t){return q.apply(this,arguments)}function q(){return q=(0,l.Z)((0,a.Z)().mark(function d(r,t,T){return(0,a.Z)().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.abrupt("return",(0,j.WY)("/api/v1/users/".concat(r),(0,i.Z)({method:"PUT",data:t},T||{})));case 1:case"end":return z.stop()}},d)})),q.apply(this,arguments)}function se(d,r){return ee.apply(this,arguments)}function ee(){return ee=(0,l.Z)((0,a.Z)().mark(function d(r,t){return(0,a.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,j.WY)("/api/v1/users/".concat(r),(0,i.Z)({method:"DELETE"},t||{})));case 1:case"end":return n.stop()}},d)})),ee.apply(this,arguments)}function ie(d,r){return ae.apply(this,arguments)}function ae(){return ae=_asyncToGenerator(_regeneratorRuntime().mark(function d(r,t){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/v1/users/".concat(r,"/reset-pwd"),_objectSpread({method:"PATCH"},t||{})));case 1:case"end":return n.stop()}},d)})),ae.apply(this,arguments)}var le=e(13668),V=e(77151),s=e(67815),P=e(46324),E=e(88101),w=e(94811),W=e(31184),$=e(12521),A=e(38102),ne=e(20406),f=e(4637),te=function(r){var t=(0,u.useState)([]),T=(0,M.Z)(t,2),n=T[0],z=T[1],R=(0,u.useState)([]),Q=(0,M.Z)(R,2),k=Q[0],L=Q[1];return(0,u.useEffect)(function(){var p=function(){var b=(0,l.Z)((0,a.Z)().mark(function h(m){var y;return(0,a.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,ne.fp)(m);case 2:if(y=o.sent,!y.data){o.next=7;break}return o.abrupt("return",y.data.map(function(J){return{label:J.name,value:J.id}}));case 7:return o.abrupt("return",[]);case 8:case"end":return o.stop()}},h)}));return function(m){return b.apply(this,arguments)}}();p({status:"enabled",resultType:"select"}).then(function(b){z(b)})},[]),(0,u.useEffect)(function(){r.value?L(r.value.map(function(p){return p.role_id})):L([])},[r.value]),(0,f.jsx)(A.Z,(0,i.Z)((0,i.Z)({allowClear:!1,showSearch:!0,mode:"tags"},r),{},{options:n,value:k,onChange:function(b){L(b),r.onChange&&r.onChange(b.map(function(h){return{role_id:h}}))}}))},ue=te,de=e(89822),ce=function(r){var t=(0,j.YB)(),T=(0,u.useRef)(),n=(0,u.useState)(),z=(0,M.Z)(n,2),R=z[0],Q=z[1];return(0,u.useEffect)(function(){var k;!r.visible||((k=T.current)===null||k===void 0||k.resetFields(),r.id&&B(r.id).then(function(){var L=(0,l.Z)((0,a.Z)().mark(function p(b){var h,m;return(0,a.Z)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:b.data&&(m=b.data,Q(m),m.statusChecked=m.status==="activated",(h=T.current)===null||h===void 0||h.setFieldsValue(m));case 1:case"end":return I.stop()}},p)}));return function(p){return L.apply(this,arguments)}}()))},[r]),(0,f.jsxs)(s.Y,{visible:r.visible,title:r.title,width:800,formRef:T,layout:"horizontal",grid:!0,rowProps:{gutter:20},submitTimeout:3e3,submitter:{searchConfig:{submitText:t.formatMessage({id:"button.confirm"}),resetText:t.formatMessage({id:"button.cancel"})}},modalProps:{destroyOnClose:!0,maskClosable:!1,onCancel:function(){r.onCancel()}},onFinish:function(){var k=(0,l.Z)((0,a.Z)().mark(function L(p){var b,h,m,y;return(0,a.Z)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(p.status=p.statusChecked?"activated":"freezed",delete p.statusChecked,p.password=p.password?de.Z.md5(p.password):void 0,!r.id){o.next=24;break}if(!(R!=null&&R.roles)){o.next=20;break}b=p.roles,h=0;case 7:if(!(h<b.length)){o.next=19;break}m=0;case 9:if(!(m<(R==null||(y=R.roles)===null||y===void 0?void 0:y.length))){o.next=16;break}if(b[h].role_id!==(R==null?void 0:R.roles[m].role_id)){o.next=13;break}return b[h].id=R==null?void 0:R.roles[m].id,o.abrupt("break",16);case 13:m++,o.next=9;break;case 16:h++,o.next=7;break;case 19:p.roles=b;case 20:return o.next=22,v(r.id,p);case 22:o.next=26;break;case 24:return o.next=26,G(p);case 26:return x.ZP.success(t.formatMessage({id:"component.message.success.save"})),r.onSuccess(),o.abrupt("return",!0);case 29:case"end":return o.stop()}},L)}));return function(L){return k.apply(this,arguments)}}(),initialValues:{statusChecked:!0},children:[(0,f.jsx)(P.Z,{name:"username",label:t.formatMessage({id:"pages.system.user.form.username"}),placeholder:t.formatMessage({id:"pages.system.user.form.username.placeholder"}),rules:[{required:!0,message:t.formatMessage({id:"pages.system.user.form.username.required"})}],colProps:{span:12}}),(0,f.jsx)(P.Z.Password,{name:"password",label:t.formatMessage({id:"pages.system.user.form.password"}),placeholder:r.id?t.formatMessage({id:"pages.system.user.form.password.update.placeholder"}):t.formatMessage({id:"pages.system.user.form.password.placeholder"}),colProps:{span:12}}),(0,f.jsx)(P.Z,{name:"name",label:t.formatMessage({id:"pages.system.user.form.name"}),placeholder:t.formatMessage({id:"pages.system.user.form.name.placeholder"}),rules:[{required:!0,message:t.formatMessage({id:"pages.system.user.form.name.required"})}],colProps:{span:12}}),(0,f.jsx)(V.Z,{span:12,children:(0,f.jsx)(E.Z,{name:"roles",label:t.formatMessage({id:"pages.system.user.form.roles"}),rules:[{required:!0,message:t.formatMessage({id:"pages.system.user.form.roles.required"})}],children:(0,f.jsx)(ue,{placeholder:t.formatMessage({id:"pages.system.user.form.roles.placeholder"})})})}),(0,f.jsx)(P.Z,{name:"email",label:t.formatMessage({id:"pages.system.user.form.email"}),placeholder:t.formatMessage({id:"pages.system.user.form.email.placeholder"}),colProps:{span:12}}),(0,f.jsx)(P.Z,{name:"phone",label:t.formatMessage({id:"pages.system.user.form.phone"}),placeholder:t.formatMessage({id:"pages.system.user.form.phone.placeholder"}),colProps:{span:12}}),(0,f.jsx)(w.Z,{name:"remark",label:t.formatMessage({id:"pages.system.user.form.remark"}),fieldProps:{rows:2},colProps:{span:24}}),(0,f.jsx)(W.Z,{name:"statusChecked",label:t.formatMessage({id:"pages.system.user.form.status"}),fieldProps:{checkedChildren:t.formatMessage({id:"pages.system.user.form.status.activated"}),unCheckedChildren:t.formatMessage({id:"pages.system.user.form.status.freezed"})},colProps:{span:12}})]})},me=ce,oe=e(3049),N;(function(d){d[d.ADD=0]="ADD",d[d.EDIT=1]="EDIT",d[d.CANCEL=2]="CANCEL"})(N||(N={}));var fe=function(){var r,t=(0,j.YB)(),T=(0,u.useRef)(),n=t.formatMessage({id:"pages.system.user.add"}),z=t.formatMessage({id:"pages.system.user.edit"}),R=t.formatMessage({id:"pages.system.user.delTip"}),Q=(0,u.useReducer)(function(h,m){var y;switch(m.type){case N.ADD:return{visible:!0,title:n};case N.EDIT:return{visible:!0,title:z,id:(y=m.payload)===null||y===void 0?void 0:y.id};case N.CANCEL:return{visible:!1,title:"",id:void 0};default:return h}},{visible:!1,title:""}),k=(0,M.Z)(Q,2),L=k[0],p=k[1],b=[{title:t.formatMessage({id:"pages.system.user.form.username"}),dataIndex:"username",width:160,key:"username"},{title:t.formatMessage({id:"pages.system.user.form.name"}),dataIndex:"name",ellipsis:!0,width:160,key:"name"},{title:t.formatMessage({id:"pages.system.user.form.roles"}),dataIndex:"roles",width:200,search:!1,render:function(m,y){var I;return y.roles?(0,f.jsx)(D.Z,{children:(I=y.roles)===null||I===void 0?void 0:I.map(function(o){return(0,f.jsx)(U.Z,{color:"blue",children:o.role_name},o.role_id)})}):"-"}},{title:t.formatMessage({id:"pages.system.user.form.status"}),dataIndex:"status",width:130,key:"status",valueType:"select",valueEnum:(r={},(0,g.Z)(r,"activated",{text:t.formatMessage({id:"pages.system.user.form.status.activated"}),status:"Success"}),(0,g.Z)(r,"freezed",{text:t.formatMessage({id:"pages.system.user.form.status.freezed"}),status:"Error"}),r),render:function(m,y){var I=y.status;return(0,f.jsx)(U.Z,{color:I==="activated"?"success":"error",children:I==="activated"?t.formatMessage({id:"pages.system.user.form.status.activated"}):t.formatMessage({id:"pages.system.user.form.status.freezed"})})}},{title:t.formatMessage({id:"pages.system.user.form.created_at"}),dataIndex:"created_at",valueType:"dateTime",search:!1,width:180},{title:t.formatMessage({id:"pages.system.user.form.updated_at"}),dataIndex:"updated_at",valueType:"dateTime",search:!1,width:180},{title:t.formatMessage({id:"pages.table.column.operation"}),valueType:"option",key:"option",width:130,render:function(m,y){return(0,f.jsxs)(D.Z,{size:2,children:[(0,f.jsx)(oe.g2,{code:"edit",onClick:function(){p({type:N.EDIT,payload:y})}},"edit"),(0,f.jsx)(oe.hC,{code:"delete",title:R,onConfirm:(0,l.Z)((0,a.Z)().mark(function I(){var o,J;return(0,a.Z)().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.next=2,se(y.id);case 2:o=re.sent,o.success&&(x.ZP.success(t.formatMessage({id:"component.message.success.delete"})),(J=T.current)===null||J===void 0||J.reload());case 4:case"end":return re.stop()}},I)}))},"delete")]})}}];return(0,f.jsxs)(Y.ZP,{children:[(0,f.jsx)(F.Z,{columns:b,actionRef:T,request:C,rowKey:"id",cardBordered:!0,search:{labelWidth:"auto"},pagination:{pageSize:10,showSizeChanger:!0},options:{density:!0,fullScreen:!0,reload:!0},dateFormatter:"string",toolBarRender:function(){return[(0,f.jsx)(oe.HS,{code:"add",onClick:function(){p({type:N.ADD})}},"add")]}}),(0,f.jsx)(me,{visible:L.visible,title:L.title,id:L.id,onCancel:function(){p({type:N.CANCEL})},onSuccess:function(){var m;p({type:N.CANCEL}),(m=T.current)===null||m===void 0||m.reload()}})]})},pe=fe},20406:function(X,_,e){"use strict";e.d(_,{fp:function(){return g},_d:function(){return D},cY:function(){return U},ul:function(){return Y},k8:function(){return j}});var a=e(78646),S=e(20686),x=e(82005),l=e(85851);function g(i,C){return K.apply(this,arguments)}function K(){return K=(0,x.Z)((0,a.Z)().mark(function i(C,O){return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,l.WY)("/api/v1/roles",(0,S.Z)({method:"GET",params:(0,S.Z)({current:"1",pageSize:"10"},C)},O||{})));case 1:case"end":return c.stop()}},i)})),K.apply(this,arguments)}function D(i,C){return Z.apply(this,arguments)}function Z(){return Z=(0,x.Z)((0,a.Z)().mark(function i(C,O){return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,l.WY)("/api/v1/roles",(0,S.Z)({method:"POST",data:C},O||{})));case 1:case"end":return c.stop()}},i)})),Z.apply(this,arguments)}function U(i,C){return M.apply(this,arguments)}function M(){return M=(0,x.Z)((0,a.Z)().mark(function i(C,O){return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,l.WY)("/api/v1/roles/".concat(C),(0,S.Z)({method:"GET"},O||{})));case 1:case"end":return c.stop()}},i)})),M.apply(this,arguments)}function Y(i,C,O){return u.apply(this,arguments)}function u(){return u=(0,x.Z)((0,a.Z)().mark(function i(C,O,G){return(0,a.Z)().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.abrupt("return",(0,l.WY)("/api/v1/roles/".concat(C),(0,S.Z)({method:"PUT",data:O},G||{})));case 1:case"end":return B.stop()}},i)})),u.apply(this,arguments)}function j(i,C){return F.apply(this,arguments)}function F(){return F=(0,x.Z)((0,a.Z)().mark(function i(C,O){return(0,a.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,l.WY)("/api/v1/roles/".concat(C),(0,S.Z)({method:"DELETE"},O||{})));case 1:case"end":return c.stop()}},i)})),F.apply(this,arguments)}}}]);
